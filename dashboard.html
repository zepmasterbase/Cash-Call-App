<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>CashCall — Dashboard</title>
  <meta name="description" content="CashCall dashboard (demo): shows wallet currency & balance." />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Manrope:wght@600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-1:#eaf6ff; --bg-2:#f7fbff; --accent-a:#00bcd4; --accent-b:#8450ff; --muted:#4b6272;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; padding:0; background: linear-gradient(180deg,var(--bg-1),var(--bg-2)); font-family:Inter,system-ui,Arial; -webkit-font-smoothing:antialiased;}
    .wrap{ max-width:420px; margin:18px auto; padding:12px; }
    header{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:10px;border-radius:12px;background:rgba(255,255,255,0.85); border:1px solid rgba(6,32,44,0.06) }
    .brand{display:flex;gap:10px;align-items:center}
    h1{ font-family:Manrope; margin:8px 0 0; font-size:20px; color:#06202b }
    .card{ margin-top:12px; padding:14px; border-radius:12px; background:rgba(255,255,255,0.95); border:1px solid rgba(6,32,44,0.04) }
    .balance { font-size:28px; font-weight:800; font-family:Manrope; margin-top:6px; color:#06202b; }
    .small{ color:var(--muted); font-size:13px }
    button{ padding:10px 12px; border-radius:10px; border:0; cursor:pointer; font-weight:700 }
    .logout{ background:linear-gradient(90deg,var(--accent-a),var(--accent-b)); color:#021026 }
    .secondary{ background:transparent; border:1px solid rgba(6,32,44,0.06); color:var(--muted) }
    footer{ margin-top:12px; color:var(--muted); font-size:13px; text-align:center }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div style="width:44px;height:44px;display:grid;place-items:center;border-radius:10px;background:linear-gradient(90deg,var(--accent-a),var(--accent-b));color:#021026;font-weight:900">C</div>
        <div>
          <div style="font-size:13px;color:var(--muted)">Welcome</div>
          <div id="userName" style="font-weight:800;font-family:Manrope"></div>
        </div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <button id="refreshBtn" class="secondary">Refresh</button>
        <button id="logoutBtn" class="logout">Log out</button>
      </div>
    </header>

    <section class="card" aria-live="polite">
      <div class="small">Wallet</div>
      <div id="walletCurrency" class="small" style="margin-top:6px"></div>
      <div id="walletBalance" class="balance">0.00</div>

      <div style="display:flex;gap:8px;margin-top:12px;">
        <button id="receiveBtn" class="secondary" style="flex:1" onclick="alert('Receive flow (demo)')">Receive</button>
        <button id="sendBtn" class="secondary" style="flex:1" onclick="alert('Send flow (demo)')">Send</button>
      </div>
    </section>

    <section class="card" style="margin-top:12px;">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div><div class="small">Account</div><div id="accountEmail" style="font-weight:700"></div></div>
        <div><div class="small">Country</div><div id="accountCountry" style="font-weight:700"></div></div>
      </div>
    </section>

    <footer>© <span id="year"></span> CashCall</footer>
  </div>

  <script>
    // read session from localStorage
    function loadSession(){
      const token = localStorage.getItem('cashcall_token');
      const user = JSON.parse(localStorage.getItem('cashcall_user') || 'null');
      const wallet = JSON.parse(localStorage.getItem('cashcall_wallet') || 'null');

      if (!token || !user || !wallet) {
        // not authenticated: send to signup/login
        window.location.href = 'signup.html';
        return null;
      }
      return { token, user, wallet };
    }

    function render(){
      const s = loadSession();
      if (!s) return;
      const { user, wallet } = s;
      document.getElementById('userName').textContent = user.name || user.email || 'User';
      document.getElementById('accountEmail').textContent = user.email || '';
      // map country code to label
      const labels = { ng: 'Nigeria', za: 'South Africa', gh: 'Ghana' };
      document.getElementById('accountCountry').textContent = labels[user.country] || user.country;
      document.getElementById('walletCurrency').textContent = 'Currency: ' + wallet.currency;
      // format balance (simple)
      document.getElementById('walletBalance').textContent = new Intl.NumberFormat(undefined, { style: 'currency', currency: wallet.currency, minimumFractionDigits: 2 }).format(wallet.balance);
    }

    // logout
    document.getElementById('logoutBtn').addEventListener('click', () => {
      localStorage.removeItem('cashcall_token');
      localStorage.removeItem('cashcall_user');
      localStorage.removeItem('cashcall_wallet');
      window.location.href = 'signup.html';
    });

    // refresh button (re-read localStorage)
    document.getElementById('refreshBtn').addEventListener('click', render);

    document.getElementById('year').textContent = new Date().getFullYear();

    // initial render
    render();
  </script>
</body>
</html>